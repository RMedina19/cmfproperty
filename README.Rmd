---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  warning = FALSE
)
```

# cmfproperty

This package analyzes property tax regressivity and produces various tables and figures for a sales ratio study.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("erhla/cmfproperty")
```
## Example

This is the basic framework to conduct a sales ratio study:

```{r example}
library(cmfproperty)
df <- cmfproperty::example_data
df <-
  cmfproperty::reformat_data(
    df,
    sale_col = "SALE_PRICE",
    assessment_col = "ASSESSED_VALUE",
    sale_year_col = "SALE_YEAR",
    filter_data = TRUE
  )
stats <- cmfproperty::calc_iaao_stats(df)
head(stats)
```


Data is required to have at least three columns, Sale Year, Sale Price, and Assessed Value.
```{r dataoverview}
head(cmfproperty::example_data)
```

reformat_data then adds additional calculated fields:

* RATIO, which is the Sales Ratio (Sale Price / Assessed Value)
* arms_length_transaction, an indicator that the property was sold in an arm's length transaction (calculated using the IAAO standard)
* SALE_PRICE_ADJ, inflation adjusted sale price (adjusted to the last year of available data)
* ASSESSED_VALUE_ADJ, inflation adjusted assessed value (adjusted to the last year of available data)


```{r reformatoverview}
df <- cmfproperty::example_data
df <-
  cmfproperty::reformat_data(
    df,
    sale_col = "SALE_PRICE",
    assessment_col = "ASSESSED_VALUE",
    sale_year_col = "SALE_YEAR",
    filter_data = TRUE
  )
head(as.data.frame(df)) #just to print all the columns
```


More advanced features are available as well:
```{r example2}
cmfproperty::regression_tests(df)
```

```{r example3}
plot_ls <-
  cmfproperty::plots(stats,
                     df,
                     min_reporting_yr = 2006,
                     max_reporting_yr = 2016)
plot_ls[[1]]
plot_ls[[2]]
plot_ls[[3]]
plot_ls[[4]]
```

